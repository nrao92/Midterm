<!DOCTYPE html>
<html>
    <head>
        <title>Midterm Practical</title>
        
       <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
        integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin=""/>

        <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
        integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
        crossorigin=""></script>
        
        <style type="text/css">
        html, body { margin: 0; padding: 0; height: 100%; }
        #map { min-height: 100%; }
        </style>
        
        <script type="text/javascript" src="dataS.js"></script>
        <script type="text/javascript" src="dataC.js"></script>
<style>
      .legend {
          padding: 6px 8px;
          line-height: 18px;
          background: rgba(255,255,255,0.9);
          box-shadow: 0 0 15px rgba(0,0,0,0.2);
          border-radius: 5px;
      }

       .legend i {
          width: 18px;
          height: 18px;
          float: left;
          margin-right: 8px;
        opacity: 0.7;
  }
        </style>
<style>
    .info {
    padding: 6px 8px;
    font: 14px/16px Arial, Helvetica, sans-serif;
    background: black;
    background: rgba(255,255,255,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    border-radius: 5px;
}
.info h4 {
    margin: 0 0 5px;
    color: #225ea8;
}</style>  

        <link rel="icon" href="favicon.png" >    
</head>
    
<body>
    <div id="map" style="height: 500px"></div>

    <script type="text/javascript">

          var map = L.map('map', {
              center: [33.1497964,-99.7857214],
              zoom: 4
          });
        
        var canvas = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
           attribution: 'Map data © OpenStreetMap contributors, CC-BY-SA, Imagery © Mapbox',
           maxZoom: 11,
           minZoom: 4,
           id: 'mapbox.dark',
           accessToken:'pk.eyJ1IjoiY3VyZW1hbmdvIiwiYSI6ImNpcTQ4cGFwbDAxbmVmd25vZGNiOTVzeGEifQ.GWZByYkIft6eMRha69C8nw'
         }).addTo(map);
        
   function getColor(value) {
        return value > 22? '#88419d':
                value > 14 ? '#8c96c6':
                value > 12 ? '#b3cde3':
                             '#edf8fb';
}
        function style(feature){
        return {
            fillColor: getColor(feature.properties.per_aging), 
            weight: 1,
            opacity: 1,
            color: 'black',
            fillOpacity: 1
            
        };
        }
        
        function highlightFeature(e) {
        var layer = e.target;
        info.update(layer.feature.properties);

            layer.setStyle({
                weight: 3,
                color: '#cb181d',
                dashArray: '',
                fillOpacity: 0.7
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                layer.bringToFront();
            }
        }

            
        var counties =  L.geoJson(dataC,{style:style,onEachFeature: onEachFeature}).addTo(map);    
        
        var states =  L.geoJson(dataS,{style:style,onEachFeature: onEachFeature}).addTo(map); 
        
        
        var info = L.control();

        info.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
            this.update();
            return this._div;
        };

        // method that we will use to update the control based on feature properties passed
        info.update = function (props) {
            this._div.innerHTML = '<h4>US Percent Aging Population</h4>' +  (props ?
                '<b>' + props.NAME10 + '</b><br />' + props.per_aging + '%'
                : 'Hover over state or county');
        };

        info.addTo(map);
        
        function resetHighlight(e) {
        states.resetStyle(e.target);
        counties.resetStyle(e.target);
        info.update();
}   
        function onEachFeature(feature, layer) {
        layer.on({
        mouseover: highlightFeature, // Do what defined by the highlightFeature function on mouseover
        mouseout: resetHighlight,    // Do what defined by the resetHighlight function on mouseout
    });
}
    
          var legend = L.control({position: 'bottomright'}); // Try the other three corners if you like.

            legend.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'legend'),
            grades = [3, 12, 14, 22]; // The break values to define the intervals of population, note we begin from 0 here

                div.innerHTML = '<b> Percent Aging <br> (%) </br></b>'; // The legend title (HTML-based), in this case it's Population Density 2011

                // Loop through our the classes and generate a label with a color box for each interval.
                // If you are creating a choropleth map, you DO NOT need to change lines below.
                for (var i = 0; i < grades.length; i++) {
                    div.innerHTML +=
                    '<i style="background:' + getColor(grades[i] + 1) + '"></i>' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
                }

                return div;
};

legend.addTo(map);
            
            var basemaps = {
                "Light Canvas": canvas
            };

            var overlaymaps = {
                "State-Level": states,
                "County-Level" : counties
            };
            
            
            L.control.layers(basemaps,overlaymaps,{position: 'topleft'}).addTo(map);
    
        

        </script>
    </body>
</html>
  